import{r as c,t as g,c as u,j as s,m as Z,v as ss,b as d,B as b,d as N,e as A,x as es,l as ts,n as as,a as is}from"./index-D7tVnmx7.js";import{C as S,a as I,b as rs,c as ns}from"./card-G-I0PeXl.js";import{C as ls,a as os,b as ds}from"./chart-lu-FldkB.js";import{A as cs,a as ms,X as us,Y as xs,b as hs}from"./AreaChart-ChD5yDrG.js";const f="#4fd1c5",ps=()=>s.jsxs("div",{className:"pointer-events-none fixed inset-0 -z-10 overflow-hidden",children:[s.jsxs("svg",{viewBox:"0 0 900 900",className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[95vmin] opacity-30",style:{filter:"blur(20px)"},children:[s.jsxs("defs",{children:[s.jsxs("radialGradient",{id:"rb",cx:"50%",cy:"50%",children:[s.jsx("stop",{offset:"0%",stopColor:"#04111a"}),s.jsx("stop",{offset:"100%",stopColor:"#001012"})]}),s.jsxs("linearGradient",{id:"lg",x1:"0%",x2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#07282b"}),s.jsx("stop",{offset:"100%",stopColor:f})]})]}),s.jsxs("g",{style:{transformOrigin:"50% 50%",animation:"globe-rotate 45s linear infinite"},children:[s.jsx("circle",{cx:"450",cy:"450",r:"330",fill:"url(#rb)",stroke:"rgba(79,209,197,0.04)",strokeWidth:"1"}),[...Array(10)].map((x,l)=>s.jsx("ellipse",{cx:"450",cy:"450",rx:300-l*28,ry:(300-l*28)*(.34+l%2*.02),fill:"none",stroke:"rgba(79,209,197,0.03)",strokeWidth:"1"},l)),[...Array(20)].map((x,l)=>{const h=l/20*Math.PI*2,j=450+Math.cos(h)*260,m=450+Math.sin(h)*110;return s.jsx("circle",{cx:j,cy:m,r:3,fill:l%2?f:"#00b5d8",opacity:.9},l)}),s.jsx("circle",{cx:"450",cy:"450",r:"340",fill:"none",stroke:"url(#lg)",strokeWidth:"2",opacity:"0.05"})]})]}),s.jsx("style",{children:`
      @keyframes globe-rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
    `})]}),gs=({active:x,setActive:l,logout:h})=>{const j=[{key:"Overview",label:"Dashboard"},{key:"Institutions",label:"Institutions"},{key:"Faculties",label:"Faculties"},{key:"Courses",label:"Courses"},{key:"Companies",label:"Companies"},{key:"Students",label:"Students"},{key:"Admissions",label:"Admissions"},{key:"Reports",label:"Reports"}];return s.jsxs("aside",{className:"w-72 min-h-screen px-6 pt-8 pb-6 bg-[rgba(0,0,0,0.3)] border-r border-[rgba(255,255,255,0.02)] fixed left-0 top-0",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("div",{className:"text-white text-2xl font-bold",children:"Admin Console"}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Faculty of ICT"})]}),s.jsx("nav",{className:"space-y-2",children:j.map(m=>s.jsx("button",{onClick:()=>l(m.key),className:`w-full px-3 py-2 rounded-lg text-left ${x===m.key?"bg-[rgba(79,209,197,0.06)]":"hover:bg-[rgba(255,255,255,0.03)]"}`,children:s.jsx("span",{className:"text-sm text-white",children:m.label})},m.key))}),s.jsxs("div",{className:"mt-10 text-gray-300 text-sm",children:[s.jsx("div",{children:"Logged in as"}),s.jsx("div",{className:"text-white font-semibold",children:"Admin"}),s.jsx(b,{onClick:h,variant:"destructive",className:"mt-3",children:"Logout"})]})]})};function ys(){const[x,l]=c.useState("Overview"),[h,j]=c.useState([]),[m,E]=c.useState([]),[R,D]=c.useState([]),[k,F]=c.useState([]),[O,z]=c.useState([]),[T,P]=c.useState([]),[w,G]=c.useState([]),[C,B]=c.useState({totalInstitutions:0,totalStudents:0,totalCompanies:0,totalAdmissions:0}),[L,W]=c.useState([]),$=async()=>{await ss(is),window.location.href="/login"};c.useEffect(()=>{p()},[]);const p=async()=>{const e=await g(u(d,"institutions")),t=await g(u(d,"faculties")),a=await g(u(d,"courses")),n=await g(u(d,"companies")),o=await g(u(d,"students")),y=await g(u(d,"admissions")),r=await g(u(d,"registrations"));j(e.docs.map(i=>({id:i.id,...i.data()}))),E(t.docs.map(i=>({id:i.id,...i.data()}))),D(a.docs.map(i=>({id:i.id,...i.data()}))),F(n.docs.map(i=>({id:i.id,...i.data()}))),z(o.docs.map(i=>({id:i.id,...i.data()}))),P(y.docs.map(i=>({id:i.id,...i.data()}))),G(r.docs.map(i=>({id:i.id,...i.data()}))),B({totalInstitutions:e.size,totalStudents:o.size,totalCompanies:n.size,totalAdmissions:y.size}),W([{name:"Institutions",value:e.size},{name:"Students",value:o.size},{name:"Companies",value:n.size},{name:"Admissions",value:y.size}])},M=async(e,t)=>{try{const a=e==="institutions"?"institution":"company",o=await(await fetch("https://landing-x99b.onrender.com/api/admin/approve-registration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,email:t.email,name:t.name,role:a})})).json();o.success?(alert(`${t.name} approved! Email sent with generated password.`),p()):alert("Approval failed: "+o.message)}catch(a){console.error("Error approving:",a),alert("Failed to approve")}},U=async(e,t)=>{try{const a=N(d,e,t);await A(a,{status:"suspended"}),p()}catch(a){console.error("Error suspending:",a),alert("Failed to suspend")}},J=async e=>{try{const t=N(d,"institutions",e);await A(t,{published:!0}),p()}catch(t){console.error("Error publishing:",t),alert("Failed to publish admissions")}},K=async(e,t,a)=>{const n=prompt(`Update ${e.slice(0,-1)} name:`,a);if(!(!n||n===a))try{const o=N(d,e,t);await A(o,{name:n}),p()}catch(o){console.error("Error updating:",o),alert("Failed to update")}},X=async(e,t)=>{try{const a=N(d,e,t);await es(a),p()}catch(a){console.error("Error deleting:",a),alert("Failed to delete")}},Y=async e=>{const t=prompt(`Enter ${e.slice(0,-1)} name:`);if(!t)return;let a={};if(e==="faculties"||e==="courses"){const n=prompt("Enter Institution ID:");if(!n)return;a.institutionId=n}try{const n=u(d,e);await ts(n,{name:t,status:"pending",createdAt:as(),...a}),p()}catch(n){console.error("Error adding:",n),alert("Failed to add")}},v=(e,t,a=!1,n=!1,o=!1,y=!0)=>s.jsxs("div",{className:"space-y-3",children:[e.map(r=>s.jsxs("div",{className:"p-4 bg-[rgba(255,255,255,0.05)] rounded flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-white font-semibold",children:r.name}),r.email&&s.jsx("div",{className:"text-gray-400",children:r.email}),r.status&&s.jsxs("div",{className:"text-gray-400 text-sm",children:["Status: ",r.status]}),r.institutionId&&s.jsxs("div",{className:"text-gray-400 text-sm",children:["Institution ID: ",r.institutionId]})]}),s.jsxs("div",{className:"flex gap-2",children:[a&&r.status!=="approved"&&s.jsx(b,{onClick:()=>M(t,r),className:"bg-teal-600 hover:bg-teal-700",children:"Approve"}),n&&r.status!=="suspended"&&s.jsx(b,{onClick:()=>U(t,r.id),className:"bg-yellow-600 hover:bg-yellow-700",children:"Suspend"}),o&&!r.published&&s.jsx(b,{onClick:()=>J(r.id),className:"bg-green-600 hover:bg-green-700",children:"Publish"}),y&&s.jsx(b,{onClick:()=>K(t,r.id,r.name),className:"bg-blue-600 hover:bg-blue-700",children:"Update"}),s.jsx(b,{onClick:()=>X(t,r.id),variant:"destructive",children:"Delete"})]})]},r.id)),s.jsxs(b,{onClick:()=>Y(t),className:"mt-4 bg-blue-600 hover:bg-blue-700",children:["Add ",t.slice(0,-1)]})]}),_=()=>s.jsx("div",{className:"space-y-3",children:O.map(e=>{const t=w.filter(a=>a.studentId===e.id);return s.jsxs("div",{className:"p-4 bg-[rgba(255,255,255,0.05)] rounded",children:[s.jsx("div",{className:"text-white font-semibold",children:e.name||e.email}),s.jsxs("div",{className:"text-gray-400",children:["Registrations: ",t.length]}),t.map(a=>s.jsxs("div",{className:"text-gray-400 text-sm",children:["- ",a.type,": ",a.courseName||a.jobTitle," (",a.status,")"]},a.id))]},e.id)})}),H=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"text-white text-xl",children:"System Reports"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"p-4 bg-[rgba(255,255,255,0.05)] rounded",children:[s.jsx("h3",{className:"text-white font-semibold",children:"Course Applications"}),s.jsx("div",{className:"text-2xl",children:w.filter(e=>e.type==="course").length})]}),s.jsxs("div",{className:"p-4 bg-[rgba(255,255,255,0.05)] rounded",children:[s.jsx("h3",{className:"text-white font-semibold",children:"Job Applications"}),s.jsx("div",{className:"text-2xl",children:w.filter(e=>e.type==="job").length})]}),s.jsxs("div",{className:"p-4 bg-[rgba(255,255,255,0.05)] rounded",children:[s.jsx("h3",{className:"text-white font-semibold",children:"Admitted Students"}),s.jsx("div",{className:"text-2xl",children:w.filter(e=>e.status==="admitted").length})]}),s.jsxs("div",{className:"p-4 bg-[rgba(255,255,255,0.05)] rounded",children:[s.jsx("h3",{className:"text-white font-semibold",children:"Pending Approvals"}),s.jsx("div",{className:"text-2xl",children:k.filter(e=>e.status==="pending").length+h.filter(e=>e.status==="pending").length})]})]})]}),V=()=>s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[{label:"Institutions",value:C.totalInstitutions},{label:"Students",value:C.totalStudents},{label:"Companies",value:C.totalCompanies},{label:"Admissions",value:C.totalAdmissions}].map((e,t)=>s.jsx(S,{className:"bg-[rgba(255,255,255,0.03)] border-[rgba(255,255,255,0.05)]",children:s.jsxs(I,{className:"p-5",children:[s.jsx("div",{className:"text-gray-300 text-sm",children:e.label}),s.jsx("div",{className:"text-2xl font-semibold text-white mt-2",children:e.value})]})},t))}),q=()=>s.jsxs(S,{className:"bg-[rgba(255,255,255,0.02)] border-[rgba(79,209,197,0.03)]",children:[s.jsx(rs,{children:s.jsx(ns,{className:"text-white",children:"System Activity Overview"})}),s.jsx(I,{children:s.jsx(ls,{config:{value:{label:"Value",color:f}},className:"h-[260px]",children:s.jsxs(ms,{data:L,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"g",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:f,stopOpacity:.4}),s.jsx("stop",{offset:"95%",stopColor:f,stopOpacity:0})]})}),s.jsx(us,{dataKey:"name",stroke:"white",tick:{fill:"white"}}),s.jsx(xs,{stroke:"white",tick:{fill:"white"}}),s.jsx(os,{content:s.jsx(ds,{})}),s.jsx(hs,{type:"monotone",dataKey:"value",stroke:f,fill:"url(#g)",strokeWidth:2})]})})})]}),Q=()=>{switch(x){case"Institutions":return v(h,"institutions",!0,!1,!0,!0);case"Faculties":return v(m,"faculties",!1,!1,!1,!0);case"Courses":return v(R,"courses",!1,!1,!1,!0);case"Companies":return v(k,"companies",!0,!0,!1,!0);case"Students":return _();case"Admissions":return v(T,"admissions",!1,!1,!1,!0);case"Reports":return H();default:return s.jsxs(s.Fragment,{children:[s.jsx(V,{}),s.jsx(q,{})]})}};return s.jsxs("div",{className:"min-h-screen w-full bg-gradient-to-b from-[#0a0a1a] via-[#0a0a2a] to-black",children:[s.jsx(ps,{}),s.jsx(gs,{active:x,setActive:l,logout:$}),s.jsx("main",{className:"ml-72 p-6 pt-10",children:s.jsx(cs,{children:s.jsx(Z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},children:Q()},x)})})]})}export{ys as default};
