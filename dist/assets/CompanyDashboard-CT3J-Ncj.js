import{r as o,u as oe,a as K,q as L,w as T,c as y,t as U,l as I,j as e,B as u,b as h,m as ce,d as P,g as Y,e as de,n as F}from"./index-D7tVnmx7.js";import{C as k,b as D,c as E,a as C}from"./card-G-I0PeXl.js";import{C as O,a as X,b as z}from"./chart-lu-FldkB.js";import{A as me,a as xe,X as H,Y as _,b as he,L as pe,B as be}from"./AreaChart-ChD5yDrG.js";import{B as ue}from"./BarChart-_yvMc_Xd.js";const B="#3ee0ff",Q="#8b5cf6",ge=(l,r)=>{let a=0;l.marks>=r.marks&&(a+=40);const v=l.experienceYears||0;a+=Math.min(v,r.minExperienceYears)*10,a+=(l.documents?.length||0)*10;let p=0;r.skills&&Array.isArray(r.skills)&&r.skills.forEach(d=>{l.skills?.includes(d)&&p++}),a+=p*10;let b="not_qualified";return a>=60&&(b="qualified"),a>=80&&(b="interview"),{score:a,status:b}},V=({label:l,value:r})=>e.jsx(k,{className:"bg-[rgba(255,255,255,0.02)] border-[rgba(62,224,255,0.04)]",children:e.jsxs(C,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-gray-300",children:l}),e.jsx("div",{className:"text-xl font-semibold text-white mt-2",children:r})]})}),fe=({section:l,onBack:r,companyId:a})=>{const[v,p]=o.useState([]),[b,d]=o.useState([]),[i,S]=o.useState({}),[N,c]=o.useState(!1),[G,J]=o.useState(!1),[g,A]=o.useState({}),[W,Z]=o.useState(0),[s,f]=o.useState({title:"",location:"",type:"",deadline:"",marks:60,minExperienceYears:0,skills:[]});o.useEffect(()=>{if(!a)return;const n=async()=>{const j=P(h,"companies",a),x=await Y(j);x.exists()&&S(x.data())},t=async()=>{const j=L(y(h,"jobs"),T("companyId","==",a)),x=await U(j);p(x.docs.map(w=>({id:w.id,...w.data()})))},m=async()=>{const j=L(y(h,"registrations"),T("companyId","==",a),T("type","==","job")),x=await U(j),w=[];for(let ie of x.docs){const q=ie.data(),R=await Y(P(h,"students",q.studentId)),$=await Y(P(h,"jobs",q.jobId));if(R.exists()&&$.exists()){const M=R.data(),le=$.data(),{score:re,status:ne}=ge(M,le);w.push({...q,studentName:M.name,finalScore:re,status:ne})}}d(w)};n(),t(),m()},[a,W]);const ee=async()=>{if(!s.title||!s.location||!s.type||!s.deadline)return alert("All fields required");c(!0);try{await I(y(h,"jobs"),{...s,companyId:a,companyName:i.name,createdAt:F()}),alert("Job posted successfully!"),f({title:"",location:"",type:"",deadline:"",marks:60,minExperienceYears:0,skills:[]})}catch(n){console.error(n),alert("Failed to post job")}c(!1)},te=async()=>{c(!0);try{await de(P(h,"companies",a),g),S(g),J(!1),alert("Profile updated!")}catch(n){console.error(n),alert("Failed to update profile")}c(!1)},ae=async n=>{const t=prompt("Enter interview time (e.g., 10:00 AM):");if(!t)return;const m=prompt("Enter interview place (e.g., Company Office, Room 101):");if(!m)return;const j=prompt("Enter interview date (e.g., 2023-10-15):");if(j){c(!0);try{await I(y(h,"notifications"),{studentId:n.studentId,companyId:a,companyName:i.name,jobId:n.jobId,jobTitle:n.jobTitle,type:"interview_invitation",message:`You have been invited for an interview for the position of ${n.jobTitle} at ${i.name}. The interview is scheduled for ${j} at ${t} at ${m}. Please bring hard copies of your documents and transcripts.`,createdAt:F(),read:!1}),alert("Interview invitation sent!"),Z(x=>x+1)}catch(x){console.error(x),alert("Failed to send invitation")}c(!1)}},se=()=>{switch(l){case"Dashboard":const n=[{name:"Jobs",count:v.length},{name:"Applicants",count:b.length}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(V,{label:"Jobs Posted",value:v.length}),e.jsx(V,{label:"Applicants",value:b.length})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(k,{className:"bg-[rgba(255,255,255,0.02)] border-[rgba(62,224,255,0.04)]",children:[e.jsx(D,{children:e.jsx(E,{className:"text-white",children:"System Overview"})}),e.jsx(C,{children:e.jsx(O,{config:{count:{label:"Count",color:B}},className:"h-[200px]",children:e.jsxs(xe,{data:n,children:[e.jsx(H,{dataKey:"name",stroke:"white",tick:{fill:"white"}}),e.jsx(_,{stroke:"white",tick:{fill:"white"}}),e.jsx(X,{content:e.jsx(z,{})}),e.jsx(he,{type:"monotone",dataKey:"count",stroke:B,fill:B+"22"})]})})})]}),e.jsxs(k,{className:"bg-[rgba(255,255,255,0.02)] border-[rgba(62,224,255,0.04)]",children:[e.jsx(D,{children:e.jsx(E,{className:"text-white",children:"System Health"})}),e.jsx(C,{children:e.jsx(O,{config:{count:{label:"Count",color:Q}},className:"h-[200px]",children:e.jsxs(ue,{data:n,children:[e.jsx(H,{dataKey:"name",stroke:"white",tick:{fill:"white"}}),e.jsx(_,{stroke:"white",tick:{fill:"white"}}),e.jsx(X,{content:e.jsx(z,{})}),e.jsx(pe,{}),e.jsx(be,{dataKey:"count",fill:Q})]})})})]})]})]});case"Post Job":return e.jsxs("div",{className:"rounded-2xl p-6 bg-[rgba(255,255,255,0.02)] border border-[rgba(62,224,255,0.04)] max-w-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Post New Job"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("input",{placeholder:"Job Title",value:s.title,onChange:t=>f({...s,title:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white"}),e.jsx("input",{placeholder:"Location",value:s.location,onChange:t=>f({...s,location:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white"}),e.jsxs("select",{value:s.type,onChange:t=>f({...s,type:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white",children:[e.jsx("option",{value:"",className:"text-black",children:"Select Type"}),e.jsx("option",{value:"Frontend Developer",className:"text-black",children:"Frontend Developer"}),e.jsx("option",{value:"Backend Developer",className:"text-black",children:"Backend Developer"}),e.jsx("option",{value:"UI/UX Designer",className:"text-black",children:"UI/UX Designer"}),e.jsx("option",{value:"Full Stack Developer",className:"text-black",children:"Full Stack Developer"})]}),e.jsx("input",{type:"date",value:s.deadline,onChange:t=>f({...s,deadline:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white"}),e.jsx("input",{type:"number",placeholder:"Minimum Marks",value:s.marks,onChange:t=>f({...s,marks:Number(t.target.value)}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white"}),e.jsx("input",{type:"number",placeholder:"Minimum Experience (Years)",value:s.minExperienceYears,onChange:t=>f({...s,minExperienceYears:Number(t.target.value)}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white"}),e.jsx("textarea",{placeholder:"Skills Required (comma separated)",onChange:t=>f({...s,skills:t.target.value.split(",").map(m=>m.trim()).filter(m=>m)}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white"})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsx(u,{onClick:ee,disabled:N,className:"bg-gradient-to-r from-[#5eead4] to-[#06b6d4] text-black font-semibold",children:N?"Posting...":"Post Job"}),e.jsx(u,{onClick:r,variant:"ghost",children:"Cancel"})]})]});case"Applicants":return e.jsxs("div",{className:"rounded-2xl p-4 bg-[rgba(255,255,255,0.02)] border border-[rgba(62,224,255,0.04)] overflow-x-auto",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Applicants"}),e.jsxs("table",{className:"min-w-full text-left divide-y divide-[rgba(255,255,255,0.04)]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-sm text-gray-400",children:[e.jsx("th",{className:"py-3 px-4",children:"Name"}),e.jsx("th",{className:"py-3 px-4",children:"Job Applied"}),e.jsx("th",{className:"py-3 px-4",children:"Score"}),e.jsx("th",{className:"py-3 px-4",children:"Status"}),e.jsx("th",{className:"py-3 px-4",children:"Applied On"})]})}),e.jsx("tbody",{className:"text-white",children:b.filter(t=>t.status==="qualified"||t.status==="interview").map((t,m)=>e.jsxs("tr",{className:"hover:bg-[rgba(255,255,255,0.01)]",children:[e.jsx("td",{className:"py-3 px-4",children:t.studentName}),e.jsx("td",{className:"py-3 px-4",children:t.jobTitle}),e.jsx("td",{className:"py-3 px-4",children:t.finalScore}),e.jsxs("td",{className:"py-3 px-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold
                        ${t.status==="qualified"?"bg-[rgba(62,224,255,0.08)] text-[rgba(62,224,255,0.9)]":t.status==="interview"?"bg-green-600/20 text-green-400":"bg-[rgba(255,255,255,0.02)] text-gray-300"}`,children:t.status}),t.status==="qualified"&&e.jsx(u,{onClick:()=>ae(t),size:"sm",className:"ml-2",children:"Invite"})]}),e.jsx("td",{className:"py-3 px-4",children:t.createdAt?.toDate().toLocaleDateString()})]},m))})]})]});case"Profile":return G?e.jsxs(k,{className:"bg-[rgba(255,255,255,0.02)] border-[rgba(62,224,255,0.04)]",children:[e.jsx(D,{children:e.jsx(E,{className:"text-white",children:"Edit Company Profile"})}),e.jsxs(C,{children:[e.jsx("input",{value:g.name||"",onChange:t=>A({...g,name:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white mb-2 w-full",placeholder:"Company Name"}),e.jsx("input",{value:g.email||"",onChange:t=>A({...g,email:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white mb-2 w-full",placeholder:"Email"}),e.jsx("input",{value:g.location||"",onChange:t=>A({...g,location:t.target.value}),className:"p-3 rounded bg-[rgba(255,255,255,0.01)] border text-white mb-2 w-full",placeholder:"Location"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(u,{onClick:te,disabled:N,className:"bg-gradient-to-r from-[#5eead4] to-[#06b6d4] text-black font-semibold",children:N?"Updating...":"Update"}),e.jsx(u,{onClick:()=>J(!1),variant:"ghost",children:"Cancel"})]})]})]}):e.jsxs(k,{className:"bg-[rgba(255,255,255,0.02)] border-[rgba(62,224,255,0.04)]",children:[e.jsx(D,{children:e.jsx(E,{className:"text-white",children:"Company Profile"})}),e.jsxs(C,{children:[e.jsx("div",{className:"text-white font-semibold text-lg",children:i.name}),e.jsxs("div",{className:"text-gray-400 text-sm",children:[i.email," · ",i.location]}),e.jsx(u,{onClick:()=>{J(!0),A({...i})},className:"mt-4 bg-gradient-to-r from-[#5eead4] to-[#06b6d4] text-black font-semibold",children:"Edit Profile"})]})]});default:return null}};return e.jsxs(ce.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},className:"w-full",children:[l!=="Dashboard"&&e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsx(u,{onClick:r,variant:"ghost",className:"px-3 py-2",children:"← Back"}),e.jsx("h2",{className:"text-2xl font-semibold text-white",children:l})]}),se()]})};function ke(){const[l,r]=o.useState("Dashboard"),[a,v]=o.useState(null),p=oe();o.useEffect(()=>{const d=K.onAuthStateChanged(async i=>{if(!i)return p("/login");if(!i.emailVerified)return p("/verify-email");const S=L(y(h,"companies"),T("firebaseUid","==",i.uid)),N=await U(S);if(N.empty){const c=await I(y(h,"companies"),{name:i.displayName||"",email:i.email,location:"",firebaseUid:i.uid,status:"pending",createdAt:F()});v(c.id),setProfile({name:i.displayName||"",email:i.email,location:""})}else{const c=N.docs[0];v(c.id),setProfile(c.data())}});return()=>d()},[p]);const b=async()=>{await K.signOut(),p("/login")};return e.jsxs("div",{className:"min-h-screen w-full text-white bg-gradient-to-b from-[#0a0a1a] via-[#0a0a2a] to-black",children:[e.jsxs("aside",{className:"fixed left-0 top-0 h-full w-72 px-6 pt-8 pb-6 border-r hidden md:block",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-2xl font-bold text-white tracking-wide",children:"Company Portal"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Employer Dashboard"})]}),e.jsxs("nav",{className:"space-y-2",children:[["Dashboard","Post Job","Applicants","Profile"].map(d=>e.jsx(u,{onClick:()=>r(d),variant:l===d?"secondary":"ghost",className:"w-full justify-start",children:d},d)),e.jsx(u,{onClick:b,variant:"destructive",className:"w-full mt-4",children:"Logout"})]})]}),e.jsx("main",{className:"ml-0 md:ml-72 p-6 pb-24 relative z-10",children:e.jsx(me,{exitBeforeEnter:!0,children:e.jsx(fe,{section:l,onBack:()=>r("Dashboard"),companyId:a},l)})})]})}export{ke as default};
